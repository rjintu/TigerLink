<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans">

  <link rel='stylesheet' type='text/css' href='static/style.css'>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans">
  <script src="jquery-3.5.1.min.js"></script>

</head>
<header>
    <h2 style="text-align: center;">Create Post</h2>
    {% include "navbar.html" %}

</header>


<body>
  <!-- Optional JavaScript; choose one of the two! -->

  <!-- Option 1: Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
    crossorigin="anonymous"></script>

  <!-- Option 2: Separate Popper and Bootstrap JS -->
  <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js" integrity="sha384-SR1sx49pcuLnqZUnnPwx6FCym0wLsk5JZuNx2bPPENzswTNFaQU1RDvt3wT4gWFG" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js" integrity="sha384-j0CNLUeiqtyaRmlzUHCPZ+Gy5fQu0dQ6eZ/xAww941Ai1SxSY+0EQqNXNE6DZiVc" crossorigin="anonymous"></script>
    -->
</body>

<form action="createpost" method="post">

  <body>
    <br>
    <div class="container">
      <div class="row justify-content-center">
        <!-- col 1 -->
        <div class="col-6">
          <div class="form-group">
            <label for="Title"><strong>Title</strong></label>
            <input type="title" class="form-control" name="title" id="title" aria-describedby="emailHelp"
              placeholder="Ex: 'TigerLink Looking for SWE Interns!'" required>
            <small id="emailHelp" class="form-text text-muted">Descriptive titles can engage audiences.</small>
          </div>
          <div class="form-group">
            <label for="content"><strong>Content</strong></label>
            <textarea type="content" class="form-control" style='height:300px' name="content" id="content" aria-describedby="emailHelp"
              placeholder="Ex: 'Basic javascript experience required!'" required></textarea>
          </div>
        </div>


        <!-- ghost spacing column -->
        <div class="col-1">

        </div>

        <!-- col 2 -->
        <div class="col-5">
          <div class="form-group">
            <strong>Which general community would you like to post to?</strong>
            <br>
            <div class="form-check">
                <input class="form-check-input" id="private" value="private" type="radio" name="role" required>
                <label class="form-check-label" for="private"> Private Post (only to specific communities) </label>
                <br>
              <input class="form-check-input" id="student" value="student" type="radio" name="role" required>
              <label class="form-check-label" for="student"> Students </label>
              <br>
              <input class="form-check-input" id="alum" value="alum" type="radio" name="role" required>
              <label class="form-check-label" for="alum"> Alums </label>
              <br>
              <input class="form-check-input" id="everyone" value="everyone" type="radio" name="role" required>
              <label class="form-check-label" for="everyone"> Everyone </label>
            </div>
            <br>

            <div class="form-group">
                <label for="groupsForm"><strong>Select the private communities you'd like to post to. (if any)</strong></label>
                <select multiple class="form-control" id="communities" name="communities">
                    {% set temp_list = [] %}
                    {% for i in interests:%}
                    <option>{{ i }}</option>
                    {{ temp_list.append(i|string)}}
                    {% endfor %}
                    <!-- send selected interests to template via Jinja -->
                </select>
            </div>
            <br>
                Upload an Image:
                <label class="file-upload-container" for="file-upload">
                  <input id="file-upload" type="file" style="background-color: gray;">
                </label>
            </div>

            <div id="loading">
                <img id="loading-image" style="display: none" src="../giphy.gif" alt="Loading..." />
            </div>
                          
        
            <input id="imgurl" name="imgurl" type="hidden" value="google.com">
          </div>
        </div>
      </div>
    </div>
  </body>

      <!-- Scripts -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <body>
    <br>
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-1">
          <button type="submit" name="submit" class="btn btn-primary">Post</button>
        </div>
      </div>
    </div>
  </body>
</form>


<!-- <script src="https://widget.cloudinary.com/v2.0/global/all.js" type="text/javascript"></script>  

<script type="text/javascript">  
var myWidget = cloudinary.createUploadWidget({
  cloudName: 'tigerlink', 
  uploadPreset: 'my_preset'}, (error, result) => { 
    if (!error && result && result.event === "success") { 
      console.log('Done! Here is the image info: ', result.info); 
    }
  }
) -->
<script>

    const CLOUDINARY_URL = 'https://api.cloudinary.com/v1_1/tigerlink/upload'; 
    const CLOUDINARY_UPLOAD_PRESET = 'uxt9emhu';

    var fileUpload = document.getElementById('file-upload');
    fileUpload.addEventListener('change', function(event) {
        var file = event.target.files[0];
        var formData = new FormData();
        formData.append('file', file);
        formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);
        document.getElementById('loading').style.display = 'block'; 
        axios({
            url: CLOUDINARY_URL,
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            data: formData
        }).then(function(res) {
            document.getElementById('loading').style.display = 'none';
            // $('#loading').hide();

            document.getElementById('imgurl').value = res.data.secure_url;
        }).catch(function(err) {
            document.getElementById('loading').style.display = 'none'; 
            console.error(err);
        });
    });
</script>


</html>